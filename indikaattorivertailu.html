<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Indikaattorivertailu | Etusivu</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_import/custom.c8d03ed8.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_import/custom.c8d03ed8.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.css">
<link rel="modulepreload" href="./_observablehq/client.js">
<link rel="modulepreload" href="./_observablehq/runtime.js">
<link rel="modulepreload" href="./_observablehq/stdlib.js">
<link rel="modulepreload" href="./_import/components/data_indikaattori.01336874.js">
<link rel="modulepreload" href="./_import/components/alueprofiilit.197586ee.js">
<link rel="modulepreload" href="./_observablehq/stdlib/duckdb.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/_esm.js">
<link rel="modulepreload" href="./_npm/@observablehq/plot@0.6.15/_esm.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/_esm.js">
<link rel="modulepreload" href="./_npm/underscore@1.13.6/_esm.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.js">
<link rel="modulepreload" href="./_npm/arquero@5.4.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/@duckdb/duckdb-wasm@1.28.0/_esm.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/_esm.js">
<link rel="modulepreload" href="./_npm/interval-tree-1d@1.0.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/apache-arrow@16.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/acorn@8.11.3/_esm.js">
<link rel="modulepreload" href="./_npm/binary-search-bounds@2.0.5/_esm.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/_esm.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/tslib@2.6.3/_esm.js">
<link rel="modulepreload" href="./_npm/flatbuffers@24.3.25/_esm.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/_esm.js">
<meta property="og:title" content="Huono-osaisuus Suomessa -karttasovellus"><meta property="og:url" content="https://karttasovellus.diak.fi"><meta property="og:image" content="https://markuskainu.fi/posts/2024-05-30-diak-karttasovellus/karttasovellus2024.png"><meta property="og:description" content="Sovelluksessa voit tarkastella erilaisia huono-osaisuuden osoittimia, osoittimien välisiä yhteyksiä sekä luoda profiileja alueista. Postinumeroaluetietoihin on lisäksi oma näkymänsä."><meta name="twitter:title" content="Huono-osaisuus Suomessa -karttasovellus"><meta name="twitter:description" content="Sovelluksessa voit tarkastella erilaisia huono-osaisuuden osoittimia, osoittimien välisiä yhteyksiä sekä luoda profiileja alueista. Postinumeroaluetietoihin on lisäksi oma näkymänsä."><meta name="twitter:image" content="https://markuskainu.fi/posts/2024-05-30-diak-karttasovellus/karttasovellus2024.png"><meta name="twitter:card" content="summary_large_image">
<script type="module">

import {define} from "./_observablehq/client.js";
import {registerFile} from "./_observablehq/stdlib.js";

registerFile("./data/df.csv", {"name":"./data/df.csv","mimeType":"text/csv","path":"./_file/data/df.e033f7be.csv","lastModified":1718182563847});
registerFile("./data/df_aikasarja.csv", {"name":"./data/df_aikasarja.csv","mimeType":"text/csv","path":"./_file/data/df_aikasarja.0d014aa5.csv","lastModified":1718182566883});
registerFile("./data/df_alueprofiilit.json", {"name":"./data/df_alueprofiilit.json","mimeType":"application/json","path":"./_file/data/df_alueprofiilit.4b415339.json","lastModified":1718182129038});
registerFile("./data/df_indicator_list.json", {"name":"./data/df_indicator_list.json","mimeType":"application/json","path":"./_file/data/df_indicator_list.7697f8c3.json","lastModified":1718182562195});
registerFile("./data/df_kuntalist.json", {"name":"./data/df_kuntalist.json","mimeType":"application/json","path":"./_file/data/df_kuntalist.b688ea70.json","lastModified":1718182140947});
registerFile("./data/df_muuttujakuvaukset.json", {"name":"./data/df_muuttujakuvaukset.json","mimeType":"application/json","path":"./_file/data/df_muuttujakuvaukset.0934d6f6.json","lastModified":1718182127322});
registerFile("./data/df_region.json", {"name":"./data/df_region.json","mimeType":"application/json","path":"./_file/data/df_region.ae39e874.json","lastModified":1718182131683});

define({id: "242ceb10", outputs: ["df","InputRegioLevel","indicator_list","SelYear","df_aikasarja","region_levels","financial1","df_region","df_kuntalist","all_var_class","unsafe_html"], body: async () => {
const [{df, InputRegioLevel, indicator_list, SelYear, df_aikasarja, region_levels, financial1, df_region, df_kuntalist, all_var_class}, {unsafe_html}] = await Promise.all([import("./_import/components/data_indikaattori.01336874.js"), import("./_import/components/alueprofiilit.197586ee.js")]);

return {df,InputRegioLevel,indicator_list,SelYear,df_aikasarja,region_levels,financial1,df_region,df_kuntalist,all_var_class,unsafe_html};
}});

define({id: "19560720", inputs: ["FileAttachment"], outputs: ["df_muuttujakuvaukset"], body: async (FileAttachment) => {
const df_muuttujakuvaukset = await FileAttachment("./data/df_muuttujakuvaukset.json").json("typed")
return {df_muuttujakuvaukset};
}});

define({id: "d965afd2", inputs: ["unsafe_html","meta","display"], body: async (unsafe_html,meta,display) => {
display(await(
unsafe_html`<div class="note" label = "Metatiedot">
${meta[0].link}
<br/>
<br/>
<em>${meta[0].description}</em>
</div>`
))
}});

define({id: "5e4ea3fb", inputs: ["Generators","InputRegioLevel","Inputs","all_var_class"], outputs: ["selected_regio_level","InputVarClass","selected_var_class"], body: (Generators,InputRegioLevel,Inputs,all_var_class) => {
const selected_regio_level = Generators.input(InputRegioLevel);



const InputVarClass = Inputs.select(all_var_class, {
                  //label: "muuttujaluokka",
                  value: all_var_class[0]});
const selected_var_class = Generators.input(InputVarClass);

return {selected_regio_level,InputVarClass,selected_var_class};
}});

define({id: "9e01d9de", inputs: ["Inputs","all_variable","Generators"], outputs: ["InputVar","selected_variable"], body: (Inputs,all_variable,Generators) => {
const InputVar = Inputs.select(all_variable, {
                  //label: "muuttujaluokka",
                  value: all_variable[0]});
const selected_variable = Generators.input(InputVar);
return {InputVar,selected_variable};
}});

define({id: "a3a0b544", inputs: ["Generators","SelYear"], outputs: ["selectedYear"], body: (Generators,SelYear) => {
const selectedYear = Generators.input(SelYear);
return {selectedYear};
}});

define({id: "adb59e83", inputs: ["selected_regio_level"], outputs: ["scope_choices"], body: (selected_regio_level) => {
let scope_choices
if (selected_regio_level == "Kunnat"){
  scope_choices = ["kaikki tason alueet","valittu alue ja sen naapurit"]
} else {
  scope_choices = ["kaikki tason alueet","valittu alue ja sen naapurit","valitun alueen kunnat"]
}

return {scope_choices};
}});

define({id: "a0a0879e", inputs: ["Inputs","scope_choices","Generators"], outputs: ["InputScope","selected_scope"], body: (Inputs,scope_choices,Generators) => {
const InputScope = Inputs.radio(scope_choices,{value: "kaikki tason alueet"});
const selected_scope = Generators.input(InputScope);
return {InputScope,selected_scope};
}});

define({id: "8a83135a", inputs: ["df","selected_regio_level","Inputs","Generators"], outputs: ["regNames","InputRegion","selected_region"], body: (df,selected_regio_level,Inputs,Generators) => {
var regNames = [... new Set(df.filter(d => d.regio_level == selected_regio_level).map(d => d.aluenimi))];

const InputRegion = Inputs.select(regNames.sort());
const selected_region = Generators.input(InputRegion);
return {regNames,InputRegion,selected_region};
}});

define({id: "2f9c53da", inputs: ["df","selected_var_class"], outputs: ["all_variable"], body: (df,selected_var_class) => {
const all_variable = [... new Set(df.filter(d => d.var_class == selected_var_class).map(x=>x.variable))];
return {all_variable};
}});

define({id: "8138b8ed", body: () => {
//display(df_region.features)
}});

define({id: "994f1556", body: () => {
//display(region_subset_names)
}});

define({id: "2ae32c3f", inputs: ["df_aikasarja","selectedYear","df_region","selected_regio_level","selected_scope","selected_region","selected_var_class","selected_variable","df_kuntalist"], outputs: ["df_plot","df_plot_aikasarja","df_region_ss","region_subset_names","df_plot_select","df_region_ss_select","df_plot_aikasarja_select"], body: (df_aikasarja,selectedYear,df_region,selected_regio_level,selected_scope,selected_region,selected_var_class,selected_variable,df_kuntalist) => {
// subsetit
var df_plot = df_aikasarja.filter(d => d.aika == selectedYear)
let df_plot_aikasarja
let df_region_ss = df_region.features.filter(d => d.properties.level == selected_regio_level);
// naapurit
let region_subset_names
if (selected_scope == "valittu alue ja sen naapurit"){
  region_subset_names = df_region.features.filter(d => d.properties.region_name == selected_region).map(d => d.properties.neighbours)
  
  df_plot = df_aikasarja.filter(d => d.aika == selectedYear && d.var_class == selected_var_class && d.variable == selected_variable && d.regio_level == selected_regio_level && region_subset_names[0].includes(d.aluekoodi))
  
  df_plot_aikasarja = df_aikasarja.filter(d => d.var_class == selected_var_class && d.variable == selected_variable && d.regio_level == selected_regio_level && region_subset_names[0].includes(d.aluekoodi))
  //df_region_ss = df_region.features.filter(d => region_subset_names[0].includes(d.properties.aluekoodi))
} else if (selected_scope == "valitun alueen kunnat"){
  region_subset_names = df_kuntalist.filter(d => d[selected_regio_level] ==  selected_region).map(d => d.municipality_code)
  
  df_plot = df_aikasarja.filter(d => d.aika == selectedYear && d.var_class == selected_var_class && d.variable == selected_variable && d.regio_level == "Kunnat" && region_subset_names.includes(d.aluekoodi))
  df_plot_aikasarja = df_aikasarja.filter(d => d.var_class == selected_var_class && d.variable == selected_variable && d.regio_level == "Kunnat" && region_subset_names.includes(d.aluekoodi))
  df_region_ss = df_region.features.filter(d =>  d.properties.level == "Kunnat")//region_subset_names[0].includes(d.properties.aluekoodi))
} else {
  df_plot = df_aikasarja.filter(d => d.aika == selectedYear && d.var_class == selected_var_class && d.variable == selected_variable && d.regio_level == selected_regio_level)
  df_plot_aikasarja = df_aikasarja.filter(d => d.var_class == selected_var_class && d.variable == selected_variable && d.regio_level == selected_regio_level)
  
}
// Korostukset
var df_plot_select = df_plot.filter(d => d.aluenimi == selected_region)
var df_region_ss_select = df_region_ss.filter(d => d.properties.region_name == selected_region)
var df_plot_aikasarja_select = df_plot_aikasarja.filter(d => d.aluenimi == selected_region)
return {df_plot,df_plot_aikasarja,df_region_ss,region_subset_names,df_plot_select,df_region_ss_select,df_plot_aikasarja_select};
}});

define({id: "bf409ebc", body: () => {
//var df_display = [... new Set(df_aikasarja.map(d => d.var_class))]
//display(df_display)
}});

define({id: "c6933f05", inputs: ["df_plot"], outputs: ["map_values"], body: (df_plot) => {
const map_values = new Map(df_plot.map(({aluekoodi, value}) => [aluekoodi, value]))
return {map_values};
}});

define({id: "3009adef", inline: true, inputs: ["InputVarClass","display"], body: async (InputVarClass,display) => {
display(await(
InputVarClass
))
}});

define({id: "429ffdc9", inline: true, inputs: ["InputVar","display"], body: async (InputVar,display) => {
display(await(
InputVar
))
}});

define({id: "c0905fc4", inline: true, inputs: ["SelYear","display"], body: async (SelYear,display) => {
display(await(
SelYear
))
}});

define({id: "ae0c220f", inline: true, inputs: ["InputRegioLevel","display"], body: async (InputRegioLevel,display) => {
display(await(
InputRegioLevel
))
}});

define({id: "878622a2", inline: true, inputs: ["InputRegion","display"], body: async (InputRegion,display) => {
display(await(
InputRegion
))
}});

define({id: "3ab07921", inline: true, inputs: ["InputScope","display"], body: async (InputScope,display) => {
display(await(
InputScope
))
}});

define({id: "e099e467", inputs: ["df_muuttujakuvaukset","selected_variable"], outputs: ["meta"], body: (df_muuttujakuvaukset,selected_variable) => {
var meta = df_muuttujakuvaukset.filter(d => d.variable == selected_variable)
//display(meta)
return {meta};
}});

define({id: "9f0bbb82", inline: true, inputs: ["kartta","display"], body: async (kartta,display) => {
display(await(
kartta
))
}});

define({id: "7ff6d850", inline: true, inputs: ["tolppa","display"], body: async (tolppa,display) => {
display(await(
tolppa
))
}});

define({id: "2b1fe409", inputs: ["Plot","df_region","selected_variable","selected_regio_level","selectedYear","df_region_ss","financial1","map_values","df_region_ss_select"], outputs: ["kartta"], body: (Plot,df_region,selected_variable,selected_regio_level,selectedYear,df_region_ss,financial1,map_values,df_region_ss_select) => {
//${
var kartta = Plot.plot({
  projection: {
    type: "orthographic",
    rotate: [-27, -52],
    domain: df_region
  },
  ariaLabel: "Kartakuva indikaattorista "  + selected_variable + " aluetasolla " + selected_regio_level + ", vuodelta " + selectedYear,
  ariaDescription: "Värikäs karttakuva ja sen selitys",
  title: selected_variable,
  subtitle: "Aluetasolla " + selected_regio_level + ", vuosi " + selectedYear,
  marks: [
    Plot.geo(df_region_ss, 
             {stroke: "#D2D2D2"
             }),
    Plot.geo(df_region_ss, Plot.centroid({
      //fill: (d) => map_values.get(d.properties.region_code),
      tip: true,
      channels: {
        Alue: d => d.properties.region_name,
        //Osoitin: d => d.properties.variable,
        Arvo: (d) => financial1(map_values.get(d.properties.region_code)),
      }
    })),         
    Plot.geo(df_region_ss, 
         {stroke: "#ffffff80",
          strokeWidth: 1, 
          tip: false,
          fill: (d) => map_values.get(d.properties.region_code)}
          ),
Plot.geo(df_region_ss_select, 
         {stroke: "magenta",
          strokeWidth: 2, 
          tip: false,
          fill: (d) => map_values.get(d.properties.region_code)}
          )
             ],

             
  //style: {
  //  fontFamily: "monospace",
  //  fontSize: "11px",
  //  overflow: "visible"
  //},
/*  style: {
    fontSize: "1em", 
    overflow: "visible"
  },*/
    color: {
    scheme: "plasma",
    type: "sqrt",
    range: [1, 0],
    nice: false,
    legend: true}
})

//}

return {kartta};
}});

define({id: "3ed9e5ee", inputs: ["resize","Plot","df_plot","selected_variable","selected_regio_level","selectedYear","d3","df_plot_select","financial1"], outputs: ["tolppa"], body: (resize,Plot,df_plot,selected_variable,selected_regio_level,selectedYear,d3,df_plot_select,financial1) => {
var tolppa =  resize((width, height) => Plot.plot({
  //height: height+95,
  height: 150 + df_plot.length * 18,
  width: width-95,
  marginLeft: 120, //420,
  marginRight: -50, //210,
  marginTop: 10,
  marginBottom: 110,
  ariaLabel: "Palkkikuva indikaattorista "  + selected_variable + " aluetasolla " + selected_regio_level + ", vuodelta " + selectedYear,
  ariaDescription: "Värikäs palkkikuva ja sen selitys",
  title: selected_variable,
  subtitle: "Aluetasolla " + selected_regio_level  + ", vuosi " + selectedYear,
  y: {
    domain: d3.sort(df_plot, d => -d.value).map(d => d.aluenimi),
    label: "",
    tickSize: 0,
    padding: 0.15,
  },
  x: {
    grid: true,
    tickPadding: 10,
    nice: true,
    labelOffset: 50,
    label: "arvo",
    labelAnchor: "right"//,
  },
  color: {
    range: [1, 0],
    scheme: "plasma",
    type: "sqrt",
    nice: false,
    legend: false  
  },
  marks: [
    Plot.gridY({
      stroke: "#dcdcdc",
      strokeOpacity: 1
    }),
/*    Plot.gridX({
      x: 100,
      stroke: "#3b0083",
      strokeOpacity: 1
    }), */
    Plot.ruleX({
      x: 100,
      y:100,
      stroke: "#999",
      strokeOpacity: 1
    }),
    Plot.ruleY(df_plot, {
//      x1: 100,
      x: "value", 
      y: "aluenimi", 
      fill: (d) => d.value,
      strokeWidth: 2,
      fontSize: ".6em",
    }),
    Plot.dot(df_plot, {
      x: "value", 
      y: "aluenimi", 
      fill: (d) => d.value,
      stroke: "black",
      r: 5,
      fontSize: ".6em",
    }),
    Plot.dot(df_plot_select, {
      x: "value", 
      y: "aluenimi", 
      stroke: "magenta",
      r: 7,
      fontSize: ".6em",
    }),
    Plot.dot(df_plot, {
      x: "value", 
      y: "aluenimi", 
      fill: null,
      stroke: null,
      tip: true,
      channels: {
        Arvo: (d) => financial1(d.value),
        //Alue: d => d.aluenimi,
        Osoitin: d => d.variable//,
        //Arvo: (d) => map_values.get(d.properties.region_code),
      }
    }),
     Plot.text(df_plot, {
      x: "value",
      y: "aluenimi",
      text: (d) => financial1(d.value),
      textAnchor: "start",
      dy: 10,
      fill: "black"
    })
  ]
}))
//)}
return {tolppa};
}});

define({id: "66305c7a", inline: true, inputs: ["aikasarja","display"], body: async (aikasarja,display) => {
display(await(
aikasarja
))
}});

define({id: "ec4058e9", inputs: ["resize","Plot","selected_variable","selected_regio_level","selectedYear","df_plot_aikasarja","df_plot_aikasarja_select"], outputs: ["aikasarja"], body: (resize,Plot,selected_variable,selected_regio_level,selectedYear,df_plot_aikasarja,df_plot_aikasarja_select) => {
var aikasarja =  resize((width, height) => Plot.plot({
  //height: height+95,
  width: width-95,
  marginLeft: 50, //420,
  marginRight: 70, //210,
  marginTop: 10,
  marginBottom: 110,
  ariaLabel: "Aikasarjakuva indikaattorista "  + selected_variable + " aluetasolla " + selected_regio_level + ", vuodelta " + selectedYear,
  ariaDescription: "Värikäs palkkikuva ja sen selitys",

  title: selected_variable,
  subtitle: "Aluetasolla " + selected_regio_level,
  color: {
    nice: true,
    legend: false  
  },
   x: {
    tickFormat: d => d > Math.floor(d) ? "" : `${d}`,
    grid: false,
    zero: false,
    labelOffset: 20,
    tickSize: 0
  },
   y: {
    grid: true,
    zero: false,
    label: "arvo",
    labelOffset: 60,
  },



  style: {
    //fontSize: "1em", 
    overflow: "visible"
  },
  marks: [
    //Plot.ruleY([0]),
    Plot.ruleX([selectedYear], {stroke: "magenta",strokeWidth: 1}),
    Plot.lineY(df_plot_aikasarja, {
      x: "aika", 
      y: "value", 
      stroke: "aluenimi",
      marker: "circle",
      fontSize: ".6em",
      tip: true
    }),
    Plot.lineY(df_plot_aikasarja_select, {
      x: "aika", 
      y: "value", 
      stroke: "magenta",
      strokeWidth: 2.5,
      marker: "circle",
      fontSize: ".6em",
      tip: true
    }),
    Plot.text(df_plot_aikasarja, Plot.selectLast({x: "aika", y: "value", z: "aluenimi", text: "aluenimi", textAnchor: "start", dx: 3}))

  ]
}))
//)}
return {aikasarja};
}});

</script>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link"><a href="./">Etusivu</a></li>
  </ol>
  <ol>
    <details open class="observablehq-section-active">
      <summary>Huono-osaisuus Suomessa</summary>
      <ol>
    <li class="observablehq-link observablehq-link-active"><a href="./indikaattorivertailu.html">Indikaattorivertailu</a></li>
    <li class="observablehq-link"><a href="./riippuvuustarkastelut.html">Riippuvuustarkastelut</a></li>
    <li class="observablehq-link"><a href="./postinumeroalueet.html">Postinumeroalueet</a></li>
    <li class="observablehq-link"><a href="./alueprofiilit.html">Alueprofiilit</a></li>
    <li class="observablehq-link"><a href="./data.html">Aineistot</a></li>
    <li class="observablehq-link"><a href="./saavutettavuus.html">Saavutettavuus</a></li>
    <li class="observablehq-link"><a href="./changelog.html">Muutokset</a></li>
      </ol>
    </details>
  </ol>
</nav>
<script>{Object.assign(document.createElement("a"),{href:""}).password&&location.replace(location.href);const e=document.querySelector("#observablehq-sidebar"),o=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?o.checked=r==="true":o.indeterminate=!0;for(const t of document.querySelectorAll("#observablehq-sidebar summary")){const s=t.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${t.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<div id="observablehq-center">
<header id="observablehq-header">
<div><a href="https://diakhub.fi/" target="_blank" rel="noopener noreferrer"></a><div class="container" style="float: right;"><a href="https://diakhub.fi/" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="93" height="33" viewBox="0 0 184 65" role="img" focusable="false"><g fill="none" fill-rule="evenodd"><g fill="#472A89" class="diakhub-logo__text-group" style="float: right"><path fill-rule="nonzero" d="M73.826 0l-2.664.009.211 64.55 2.664-.009z"></path><path d="M85.553.023v28.772H97.09c8.607 0 14.822-6.084 14.822-14.383 0-8.298-6.172-14.389-14.7-14.389H85.554zm4.791 4.356h6.783c5.605 0 9.95 4.193 9.95 10.07 0 5.879-4.222 9.99-9.747 9.99h-6.986V4.38z"></path><path fill-rule="nonzero" d="M121.821.023h-4.791v28.772h4.791z"></path><path d="M147.656 22.3l2.719 6.495h5.117L143.062.023h-4.914L125.6 28.795h4.995l2.719-6.495h14.342zm-1.826-4.318h-10.722l5.358-12.786 5.358 12.786h.006zm32.402 10.813h5.771l-11.74-16.479L183.269.023h-5.641l-13.565 14.882V.023h-4.797v28.772h4.797v-7.313l4.828-5.385zm-69.205 35.629V35.653h-3.25v12.985H88.636V35.653h-3.249v28.771h3.249v-12.66h17.141v12.66zm38.77-28.79h-3.25V52.57c0 5.59-3.248 8.835-8.65 8.835-5.401 0-8.73-3.244-8.73-8.835V35.634h-3.25V52.57c0 7.481 4.507 11.999 11.98 11.999 7.473 0 11.9-4.524 11.9-12V35.635zm13.473.019v28.771h12.183c6.419 0 10.236-2.92 10.236-7.812 0-3.943-2.4-6.658-6.5-7.275 3.33-.7 5.242-3.127 5.242-6.496 0-4.524-3.453-7.195-9.181-7.195h-11.98v.007zm3.249 3.163h8.57c3.817 0 6.049 1.648 6.049 4.562 0 2.914-2.232 4.686-6.048 4.686h-8.571v-9.248zm0 12.374h8.57c4.63 0 7.313 1.847 7.313 4.973 0 3.288-2.682 5.135-7.312 5.135h-8.571V51.19z"></path></g><path fill="#AB1D89" fill-rule="nonzero" d="M26.361 25.404c5.33-6.379 4.539-15.922-1.765-21.315C18.292-1.304 8.862-.504 3.533 5.875c-5.329 6.38-4.538 15.923 1.765 21.316 6.304 5.393 15.734 4.593 21.063-1.787z"></path><path fill="#F170AB" fill-rule="nonzero" d="M26.394 59.605c5.307-6.398 4.484-15.938-1.839-21.309-6.322-5.37-15.75-4.537-21.056 1.86-5.307 6.399-4.484 15.94 1.838 21.31 6.322 5.37 15.75 4.538 21.057-1.86z"></path><path fill="#AB1D89" fill-rule="nonzero" d="M60.308 59.655c5.332-6.377 4.545-15.92-1.757-21.316-6.302-5.395-15.733-4.599-21.064 1.779-5.33 6.377-4.544 15.921 1.758 21.316s15.732 4.599 21.063-1.779z"></path><path fill="#F170AB" fill-rule="nonzero" d="M57.821 24.877c4.677-5.447 4.106-13.7-1.277-18.433C51.162 1.711 43.007 2.29 38.33 7.736c-4.677 5.447-4.106 13.7 1.277 18.433 5.382 4.734 13.537 4.155 18.214-1.292z"></path></g><title>DiakHub</title></svg></a></div><span style="font-size: 22px; font-weight: 400; font-family: Noto Sans;">Huono-osaisuus Suomessa (HOS)</span><div><span style="font-size: 12px; font-weight: 400; font-family: Fira Code;">v2.0.1</span></div><hr></div>
</header>
<main id="observablehq-main" class="observablehq">
<div id="cell-242ceb10" class="observablehq observablehq--block"></div>
<div id="cell-19560720" class="observablehq observablehq--block"></div>
<div class="grid grid-cols-3">
<div class="grid grid-colspan-2">
<h1>Indikaattorivertailu</h1>
<p><strong>Indikaattorivertailun</strong> <em>valitse muuttujaluokka</em> -valikosta voit säädellä haluatko katsoa huono-osaisuuden summatietoja vai tarkemmin kunkin huono-osaisuuden ulottuvuuden osoittimia. <strong>Valitse muuttuja</strong> -valikosta voit valita tarkemman osoittimen ja <strong>valitse aluetaso</strong> -valikosta aluetason.
Voit myös valita, näkyykö piste-, kartta- ja aikasarjakuviossa:</p>
<ul>
<li>kaikki valitun tason alueet,</li>
<li>valittu alue ja sen naapurit, vai</li>
<li>valitun hyvinvointialueen kunnat</li>
</ul>
</div>
<div id="cell-d965afd2" class="observablehq observablehq--block observablehq--loading"></div>
</div>
<div id="cell-5e4ea3fb" class="observablehq observablehq--block"></div>
<div id="cell-9e01d9de" class="observablehq observablehq--block"></div>
<div id="cell-a3a0b544" class="observablehq observablehq--block"></div>
<div id="cell-adb59e83" class="observablehq observablehq--block"></div>
<div id="cell-a0a0879e" class="observablehq observablehq--block"></div>
<div id="cell-8a83135a" class="observablehq observablehq--block"></div>
<div id="cell-2f9c53da" class="observablehq observablehq--block"></div>
<div id="cell-8138b8ed" class="observablehq observablehq--block"></div>
<div id="cell-994f1556" class="observablehq observablehq--block"></div>
<div id="cell-2ae32c3f" class="observablehq observablehq--block"></div>
<div id="cell-bf409ebc" class="observablehq observablehq--block"></div>
<div id="cell-c6933f05" class="observablehq observablehq--block"></div>
<div class="grid diaknav">
<details open="" label="avaa">
<summary>Avaa/sulje valikko</summary>
<div class="grid grid-cols-2">
<div class="col">
<div><strong>Muuttujaluokka</strong><span id="cell-3009adef" class="observablehq--loading"></span></div>
<div><strong>Muuttuja</strong><span id="cell-429ffdc9" class="observablehq--loading"></span></div>
<div><strong>Vuosi</strong><span id="cell-c0905fc4" class="observablehq--loading"></span></div>
</div>
<div class="col">
<div><strong>Aluetaso</strong><span id="cell-ae0c220f" class="observablehq--loading"></span></div>
<div><strong>Valitse alue</strong><span id="cell-878622a2" class="observablehq--loading"></span></div>
<div><strong>Kuvioissa näytettävät alueet</strong><span id="cell-3ab07921" class="observablehq--loading"></span></div>
</div>
</div>
</details>
</div>
<div id="cell-e099e467" class="observablehq observablehq--block"></div>
<div class="grid grid-cols-2">
  <div class="card"> 
  <span id="cell-9f0bbb82" class="observablehq--loading"></span>
  </div>
  <div class="card" style="overflow-y: auto;"> 
  <span id="cell-7ff6d850" class="observablehq--loading"></span>
  </div>
  </div>
<div id="cell-2b1fe409" class="observablehq observablehq--block"></div>
<div id="cell-3ed9e5ee" class="observablehq observablehq--block"></div>
<div class="grid grid-cols-1">
<div class="card" style="height: 500px;">
  <span id="cell-66305c7a" class="observablehq--loading"></span>
</div>
</div>
<div id="cell-ec4058e9" class="observablehq observablehq--block"></div>
<!--div class="grid grid-cols-2" >
  <div class = "card">

```js

const div = display(document.createElement("div"));
div.style = "min-height: 560px;";
div.className = "custom-popup";

const map = L.map(div)
  .setView([65.5, 25.0],5);

var osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 16,
    attribution: '© OpenStreetMap'});

var ilmakuva = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
    maxZoom: 16,
    attribution: '© Esri'});


var baseMaps = {
    "OpenStreetMap": osm,
    "ilmakuva": ilmakuva
    };

var layerControl = L.control.layers(baseMaps).addTo(map);

map.addLayer(osm);

L.geoJSON(dfLeaflet, {style: style}).addTo(map);

['#ffffcc','#c7e9b4','#7fcdbb','#41b6c4','#2c7fb8','#253494']

function getColor(d) {
    return d > 150  ? '#ffffcc' :
           d > 125  ? '#c7e9b4' :
           d > 100   ? '#7fcdbb' :
           d > 70   ? '#41b6c4' :
           d > 50   ? '#2c7fb8' :
                      '#253494';
}

function style(feature) {
    return {
        fillColor: getColor(feature.properties.value),
        weight: 2,
        opacity: 1,
        color: 'white',
        dashArray: '3',
        fillOpacity: 1
    };
}


// vuorovaikutusta

function highlightFeature(e) {
    var layer = e.target;

    layer.setStyle({
        weight: 2,
        color: '#969696',
        dashArray: '',
        fillOpacity: 1
    });

    layer.bringToFront();
    info.update(layer.feature.properties);
}

function resetHighlight(e) {
    geojson.resetStyle(e.target);
    info.update();
}


var geojson;
// ... our listeners
//var geojson = L.geoJson(...);

function zoomToFeature(e) {
    map.fitBounds(e.target.getBounds());
}


function onEachFeature(feature, layer) {
    layer.on({
        mouseover: highlightFeature,
        mouseout: resetHighlight,
        click: zoomToFeature
    });
}

geojson = L.geoJson(dfLeaflet, {
    style: style,
    onEachFeature: onEachFeature
}).addTo(map);

// labelit
var info = L.control();

info.onAdd = function (map) {
    this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
    this.update();
    return this._div;
};

// method that we will use to update the control based on feature properties passed
info.update = function (props) {
    this._div.innerHTML = (props ? '<h4>' + props.variable + '</h4>' + '<b>' + props.region_name + '</b><br />' + props.value + ' '
        : 'Hover over a state');
};

info.addTo(map);

var legend = L.control({position: 'bottomright'});

legend.onAdd = function (map) {

    var div = L.DomUtil.create('div', 'info legend'),
        grades = [0, 50, 75, 100, 125, 150],
        labels = [];

    // loop through our density intervals and generate a label with a colored square for each interval
    for (var i = 0; i < grades.length; i++) {
        div.innerHTML +=
            '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
    }

    return div;
};

legend.addTo(map);

```

-->
<script defer="" data-domain="karttasovellus.diak.fi" src="https://plausible.vaphana.com/js/script.js"></script>
</main>
<footer id="observablehq-footer">
<div><div class="grid grid-cols-2" style="background-color: #271143; min-height: 120px;"><div><img src="https://www.diak.fi/wp-content/themes/diak/dist/images/diak-logo-2.svg" width="200px" style="padding: 20px;" alt="Diak-ammattikorkeakoulun logo"></div><div style="color: white; text-align: center; margin-top: 20px; margin-bottom: auto; ">Diakonia-ammattikorkeakoulu<br>PL 12, 00511 Helsinki </div></div></div>
</footer>
</div>
